pipeline {
    agent any

    stages {

        stage('Build') {
            steps {
                echo 'ğŸ§± Ã‰tape Build OK'
            }
        }

        stage('Clone GitHub') {
            steps {
                echo 'ğŸ“¥ Clone du dÃ©pÃ´t GitHub'
                git url: 'https://github.com/Nozha92/jenkins_demo_nozha.git',
                    branch: 'main'
            }
        }

        stage('Tests Python') {
            steps {
                echo 'ğŸ ExÃ©cution du script Python'
                sh 'python3 --version'
                sh 'python3 script.py'
            }
        }

        stage('Docker Build') {
            steps {
                echo 'ğŸ³ Build de lâ€™image Docker'
                sh 'docker --version'
                sh 'docker build -t jenkins_demo_nozha:latest .'
            }
        }

        stage('Docker Run') {
            steps {
                echo 'ğŸš€ Lancement du conteneur Docker'
                sh 'docker run --rm jenkins_demo_nozha:latest'
            }
        }

        stage('Archive artefacts') {
            steps {
                echo 'ğŸ“¦ Archivage des artefacts (si besoin)'
                // Exemple si tu crÃ©es un fichier result_github.txt
                // archiveArtifacts artifacts: 'result_github.txt', fingerprint: true
            }
        }
    }

    post {
        always {
            echo 'ğŸ“Œ Pipeline exÃ©cutÃ© (succÃ¨s ou Ã©chec)'
        }
        success {
            echo 'âœ… Pipeline terminÃ©e avec SUCCESS'
        }
        failure {
            echo 'âŒ Pipeline en erreur'
        }
    }
}
